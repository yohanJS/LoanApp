<!doctype html>
<html lang="en" class="h-100">

<head>
    <title>Loan App: A Coding Project by Yohan Garcia</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    
        <!--External StyleSheet-->
    <link href="./css/site.css" rel="stylesheet">

    <!--Font Awesome Icons-->
    <script src="https://kit.fontawesome.com/5db21ba9c6.js" crossorigin="anonymous"></script>
    <link rel="icon" href="./img/YG.svg" type="image/png">

    <!--Link Prism-->
    <link href="./css/prism.css" rel="stylesheet">
</head>

<body class="d-flex flex-column h-100">

    <!--Nav Section-->
    <nav class="navbar navbar-expand-md navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="https://www.yohancraft.com/" target="_blank"><img src="./img/YG.svg" alt="Yohan Craft Logo" height="34"></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"
                aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <ul class="navbar-nav me-auto mb-2 mb-md-0">
                    <li class="nav-item">
                        <a class="nav-link" href="./index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./app.html">Loan App</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="./code.html">The Code</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" target="_blank" href="https://github.com/yohanJS/LoanApp">Git Repo</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" target="_blank" href="https://www.yohancraft.com/">About</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!--Main Section-->
    <main class="flex-shrink-0">
        <div class="container py-4 px-5">
            <h2 class="border-1 border-bottom txt-color px-5 m-5">The Code for Loan App</h2>
            <div class="row px-5 row-cols-1 row-cols-md-2">
                <div class="col col-lg-8">
                    <pre class="line-numbers"><code class="language-javascript">
"use strict"

//Gets the id of an element
const $ =(id)=> {return document.getElementById(id)};

//this object will hold the loan information
//we will access this information and display
//the values entered by the user.
const loanInfo = {};

//get the values function
const getValues =()=> {

    //user input
    let loanAmount = parseFloat($("loan-amount").value);
    let term = parseFloat($("term").value);
    let rate = parseFloat($("rate").value);

    //Insert properties inside the LoanInfo Object
    loanInfo.amount = loanAmount;
    loanInfo.terms = term;
    loanInfo.interest = rate;

    //calculate monthly payment using pre-made formula
    let x = Math.pow(1 + (rate/1200), term); //Math.pow 
    let monthlyPayment = (loanAmount*x*(rate/1200))/(x-1);


    //this variable will hold the total amount of Interest paid
    let totalInterest = 0;

    //this variable will hold the remaining balance left
    let balance = 0;

    //Display the original values enterted by the user
    //format the numbers to only two decimal places
    $("desc").innerHTML = `<strong>Loan amount:</strong> $${loanInfo.amount.toFixed(2)}<br>`;
    $("desc").innerHTML += `<strong>Term in months:</strong> ${loanInfo.terms}<br>`;
    $("desc").innerHTML += `<strong>Rate:</strong> ${loanInfo.interest.toFixed(2)}%`;

    //Table Heading. Dark row
    let darkRow = $("tBody").insertRow();

    //We use this array to populate the Table Heading Row dynamically
    let tableHeading = ['Month', 'Payment', 'Principal', 'Interest', 'Total Interest', 'Balance'];
    
    //using a for loop we access the tableHeading array and add a new cell
    //at position index. We also add a special class that makes the data cells
    //bold and orange.
    for(var i = 0; i < tableHeading.length; i++) {
        let nC = darkRow.insertCell();
        nC.classList.add("my-bold");
        nC.innerHTML = tableHeading[i];
    }
    //The dark row needs indeed a class that makes the heading
    //dark
    darkRow.classList.add("table-dark");

    //We use a for loop to iterate over the total period of time
    //we access the object with the terms property
    for(var i = 1; i <= loanInfo.terms; i++) {

        //inserts a new row on every iteration
        let nRow = $("tBody").insertRow();

        /*******ALL CELLS THAT GO INSIDE THE ROW*******/

        //This cell holds the months
        let month = nRow.insertCell();
        month.innerHTML = i;
        
        //This cell holds the monthly payments
        let payment = nRow.insertCell();
        payment.innerHTML = `${monthlyPayment.toFixed(2)}`;

        //This cell holds the amount of money that goes to the principal
        let monthlyPrincipal = nRow.insertCell();
        //we find the principal with this formula
        let principal = monthlyPayment - (loanAmount * (rate/1200));
        monthlyPrincipal.innerHTML = `${principal.toFixed(2)}`;

        //This cell holds the monthly interest 
        let monthInterest = nRow.insertCell();
        let interest = loanAmount * (rate /1200);
        monthInterest.innerHTML = `${interest.toFixed(2)}`;
        
        //This cell holds the total interest paid
        let totalInterestPaid = nRow.insertCell();
        //we simply add the interest on every iteration
        //and store the value in a new variable
        totalInterest += interest;
        totalInterestPaid.innerHTML = `${totalInterest.toFixed(2)}`;

        //update the loan amount after every iteration
        loanAmount -= principal;

        //display the remaining balance
        let reamingBalance = nRow.insertCell();
        balance = loanAmount;
        reamingBalance.innerHTML =  `${balance.toFixed(2)}`;

    }

    //display monthly payments
    $("monthly-title").innerHTML = `<strong>Your Monthly Payments</strong>`;
    $("monthly-payment").innerHTML = `$${monthlyPayment.toFixed(2)}`;
    //display the total interest the customer will pay
    $("total-interest").innerHTML = `<strong>Total Interest:</strong> $${totalInterest.toFixed(2)}`;
    //display the total cost of the loan. add total interest and initial loanAmount
    $('total-cost').innerHTML = `<strong>Total cost:</strong> $${(totalInterest + loanInfo.amount).toFixed(2)}`;

}

//We load the script after the DOM loads
window.onload =()=> {
    //Event listener for the onlclick event
    $("calculate").onclick =()=> {
        //We make sure the customer enters valid data
        if($("loan-amount").value && $("term").value && $("rate").value && $("rate").value != 0){
            //we reset the body table first
            $("tBody").innerHTML = "";
            //then we call the getValues function
            getValues();
            //reset the form
            $("my-form").reset();
        } else {
            //added some feedback for the customer
            alert("Please enter valid numbers!\n rate must be greater than 0.")
        }
    }
}
                                                                     
                    </code></pre>
                </div>
                <div class="col col-lg-4">
                    <h5 class="txt-color">Code Desc.</h5>
                    <p class="lead">The Loan App is structured.</p>
                </div>
            </div>
        </div>
    </main>

    <!--Footer Section-->
    <footer class="footer mt-auto py-3 text-white">
        <div class="container-fluid">
            <div class="row row-cols-1 row-cols-md-3 gy-3">
                <div class="col order-last order-lg-first">
                    <div class="text-center"><span class="text-muted">&copy;2021</span> Yohan Garcia  | yohancraft@icloud.com</div>
                </div>
                <div class="col order-last d-flex align-items-center justify-content-center">
                    <a href="https://www.yohancraft.com/" target="_blank">
                        <img src="./img/YG.svg" alt="YohanCraft Logo" height="54">   
                    </a>
                </div>
                <div class="col d-flex  align-items-center justify-content-center">
                    <div class="row">
                        <div class="col"><a href="https://www.linkedin.com/in/yoanvaldes01/" target="_blank"><i class="fab fa-linkedin fa-2x txt-color"></i></a></div>
                        <div class="col"><a href="https://github.com/yohanJS" target="_blank"><i class="fab fa-github fa-2x txt-color"></i></a></div>
                        <div class="col"><a href="#"><i class="fab fa-youtube fa-2x txt-color"></i></a></div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous">
    </script>
    
    <!--linked prism js-->
    <script src="./js/prism.js"></script>
    <script>
        Prism.plugins.NormalizeWhitespace.setDefaults({
        'remove-trailing': true,
        'remove-indent': true,
        'left-trim': true,
        'right-trim': true
        })
    </script>
</body>

</html>